#!/bin/bash

if [ -f .gitignore ]; then
    mv .gitignore .gitignore.tmp
fi

> .gitignore
git status --porcelain | grep '^??' | cut -c4- >> .gitignore

if [ $PWD = ~ ]; then
    echo '.vim/fzf/' >> .gitignore
    echo '.vim/undo/' >> .gitignore
fi

sort -u .gitignore -o .gitignore

if cmp -s .gitignore .gitignore.tmp; then
    mv .gitignore.tmp .gitignore 2> /dev/null
else
    mv .gitignore.tmp .gitignore.old 2> /dev/null
fi
