#!/bin/bash -v

# home
cd ~

# package manager
if type "apt" > /dev/null 2>&1; then
    manager="apt"
    install="apt install -y"
elif type "dnf" > /dev/null 2>&1; then
    manager="dnf"
    install="dnf install -y"
fi

# build
sudo $install autoconf
sudo $install automake
sudo $install cmake
if [ $manager == "apt" ]; then sudo $install pkg-config;
elif [ $manager == "dnf" ]; then sudo $install pkgconfig; fi

# curl
sudo $install curl

# clang
sudo $install gcc # linter
sudo $install clang # completor (~/.clang_complete)
sudo $install clang-format # formatter (~/.clang-format)

# java
if [ $manager == "apt" ]; then sudo $install openjdk-8-jdk;
elif [ $manager == "dnf" ]; then sudo $install java-1.8.0-openjdk; fi

# python
curl -O https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
./Miniconda3-latest-Linux-x86_64.sh -b -p ~/.miniconda3
rm Miniconda3-latest-Linux-x86_64.sh

sudo $install python3-pip

pip3 install neovim

pip3 install flake8 # linter (~/.config/flake8)
pip3 install jedi # completor
pip3 install yapf # formatter (~/.style.yapf)

# nodejs
if [ $manager == "apt" ]; then curl -sL https://deb.nodesource.com/setup_8.x | sudo -E bash -; fi
sudo $install nodejs

if [ $manager == "apt" ]; then
    curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
    echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
    sudo apt update -y
elif [ $manager=="dnf" ]; then
    sudo wget https://dl.yarnpkg.com/rpm/yarn.repo -O /etc/yum.repos.d/yarn.repo
fi
sudo $install yarn

yarn global add eslint # linter
yarn global add js-beautify prettier-eslint-cli # formatter
yarn global add tern # completor

# rust
sudo $install cargo

cargo install ripgrep

# vim
if [ $manager == "apt" ]; then sudo add-apt-repository ppa:jonathonf/vim && sudo apt update -y; fi
sudo $install vim

curl -fLo ~/.vim/autoload/plug.vim --create-dirs \
      https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
vim +PlugInstall +qa

mkdir ~/.vim/undo

# drive
if [ $manager == "apt" ]; then
    sudo add-apt-repository -y ppa:twodopeshaggy/drive && sudo apt update -y
    sudo $install drive
elif [ $manager == "dnf" ]; then
    sudo dnf copr enable -y vaughan/drive-google
    sudo $install drive-google
fi

# universal-ctags
git clone https://github.com/universal-ctags/ctags
cd ctags

./autogen.sh 
./configure
make
sudo make install

cd ..
rm -rf ctags

# tmux
sudo $install tmux

# xsel
sudo $install xsel

# ranger
sudo $install ranger

# zsh
sudo $install zsh

mkdir ~/.antigen
curl -L git.io/antigen > ~/.antigen/antigen.zsh

chsh -s $(which zsh)
