#!/bin/bash -v

# check if Sunday
if [ $(date +%u) -ne 7 ]; then
   echo "Today's not Sunday yet. Have a good day and be productive!"
   exit 1
fi

# package managers
if type "apt" > /dev/null 2>&1; then
	manager="apt"
elif type "dnf" > /dev/null 2>&1; then
	manager="dnf"
fi

# system
if [ $manager == "apt" ]; then sudo apt update -y; sudo apt upgrade -y; fi
if [ $manager == "dnf" ]; then sudo dnf upgrade -y; fi

# zsh
upgrade_oh_my_zsh

# neovim
nvim -c 'PlugUpgrade' -c 'qa!'
nvim -c 'PlugUpdate' -c 'qa!'

# pip
sudo -H pip2 install --upgrade pip
sudo -H pip3 install --upgrade pip

pip2 freeze --local | grep -v '^\-e' | cut -d = -f 1  | xargs -n1 pip2 install --user -U
pip3 freeze --local | grep -v '^\-e' | cut -d = -f 1  | xargs -n1 pip3 install --user -U

# universal-ctags
git clone https://github.com/universal-ctags/ctags.git
cd ctags

./autogen.sh 
./configure
make
sudo make install

cd ..
rm -rf ctags

# calibre
if type "calibre" > /dev/null 2>&1; then
   sudo -v && wget -nv -O- https://download.calibre-ebook.com/linux-installer.py | sudo python -c "import sys; main=lambda:sys.stderr.write('Download failed\n'); exec(sys.stdin.read()); main()"
fi
