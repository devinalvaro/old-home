# set tmux prefix
unbind-key C-b
set -g prefix C-Space
bind-key C-Space last-window

# upgrade $TERM
set -g terminal-overrides ',xterm-256color:Tc'
set -g default-terminal 'screen-256color'

# auto window rename
set -g automatic-rename

# base-1 indexing
set -g base-index 1
setw -g pane-base-index 1

# auto renumber window
set -g renumber-windows on

# escape time
set -s escape-time 0

# increase scrollback buffer size
set -g history-limit 50000

# fix vim focus issues
set -g focus-events off

# emacs keybindings
set -g status-keys emacs

# vi keybindings
set -g mode-keys vi

bind-key -T copy-mode-vi 'v' send-keys -X begin-selection
bind-key -T copy-mode-vi 'V' send-keys -X select-line
bind-key -T copy-mode-vi 'r' send-keys -X rectangle-toggle
bind-key -T copy-mode-vi 'y' send-keys -X copy-pipe 'xsel -i -p -b'

# bind-key reload
bind-key r source-file ~/.tmux.conf \; display-message 'Config reloaded.'

# new window bindings
bind-key 'c' new-window -c '#{pane_current_path}'
bind-key 'h' new-window -c '~'

# bind-key kill pane
bind-key '&' kill-window
bind-key 'x' kill-pane

# pane split bindings
bind-key '|' split-window -h -c '#{pane_current_path}'
bind-key '_' split-window -v -c '#{pane_current_path}'

# pane resizing bindings
bind-key -r 'H' resize-pane -L 8
bind-key -r 'J' resize-pane -D 4
bind-key -r 'K' resize-pane -U 4
bind-key -r 'L' resize-pane -R 8

# pane movement bindings
is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"

bind-key -r C-h if-shell '$is_vim' 'send-keys C-h'  'select-pane -L'
bind-key -r C-j if-shell '$is_vim' 'send-keys C-j'  'select-pane -D'
bind-key -r C-k if-shell '$is_vim' 'send-keys C-k'  'select-pane -U'
bind-key -r C-l if-shell '$is_vim' 'send-keys C-l'  'select-pane -R'
bind-key -r C-\ if-shell '$is_vim' 'send-keys C-\\' 'select-pane -l'

bind-key -T copy-mode-vi C-h if-shell '$is_vim' 'send-keys C-h'  'select-pane -L'
bind-key -T copy-mode-vi C-j if-shell '$is_vim' 'send-keys C-j'  'select-pane -D'
bind-key -T copy-mode-vi C-k if-shell '$is_vim' 'send-keys C-k'  'select-pane -U'
bind-key -T copy-mode-vi C-l if-shell '$is_vim' 'send-keys C-l'  'select-pane -R'
bind-key -T copy-mode-vi C-\ if-shell '$is_vim' 'send-keys C-\\' 'select-pane -l'

# window movement bindings
bind-key -n M-1 select-window -t 1
bind-key -n M-2 select-window -t 2
bind-key -n M-3 select-window -t 3
bind-key -n M-4 select-window -t 4
bind-key -n M-5 select-window -t 5
bind-key -n M-6 select-window -t 6
bind-key -n M-7 select-window -t 7
bind-key -n M-8 select-window -t 8
bind-key -n M-9 select-window -t 9

# window swap bindings
bind-key M-1 swap-window -t 1
bind-key M-2 swap-window -t 2
bind-key M-3 swap-window -t 3
bind-key M-4 swap-window -t 4
bind-key M-5 swap-window -t 5
bind-key M-6 swap-window -t 6
bind-key M-7 swap-window -t 7
bind-key M-8 swap-window -t 8
bind-key M-9 swap-window -t 9

# status bar
set -g status on
set -g status-interval 1

set -g status-position top
set -g status-justify centre

set -g status-bg black
set -g status-fg white
set -g status-attr none

set -g pane-border-bg black
set -g pane-border-fg black
set -g pane-active-border-bg black
set -g pane-active-border-fg brightblack
set -g display-panes-colour black
set -g display-panes-active-colour brightblack

setw -g clock-mode-colour cyan

set -g message-fg cyan
set -g message-bg brightblack
set -g message-command-fg cyan
set -g message-command-bg brightblack

set -g status-left ''
set -g status-right ''

set -g window-status-format '#[fg=white,bg=black] #I #[fg=white,bg=black]#W #F '
set -g window-status-current-format '#[fg=black,bg=cyan] #I #[fg=black,bg=cyan]#W #F '
set -g window-status-separator ''
